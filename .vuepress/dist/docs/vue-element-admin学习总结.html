<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue-element-admin | 高分云前端文档</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="~~~~~~~~~">
    
    <link rel="preload" href="/assets/css/0.styles.64f7ac41.css" as="style"><link rel="preload" href="/assets/js/app.436fbc8c.js" as="script"><link rel="preload" href="/assets/js/2.816dcc9d.js" as="script"><link rel="preload" href="/assets/js/3.48361560.js" as="script"><link rel="prefetch" href="/assets/js/10.7addb268.js"><link rel="prefetch" href="/assets/js/11.524e1e81.js"><link rel="prefetch" href="/assets/js/12.6d80a7fe.js"><link rel="prefetch" href="/assets/js/13.5b2e208a.js"><link rel="prefetch" href="/assets/js/14.6f891da4.js"><link rel="prefetch" href="/assets/js/15.cf9ef8e0.js"><link rel="prefetch" href="/assets/js/16.a3c24ba8.js"><link rel="prefetch" href="/assets/js/17.4fb2c1c3.js"><link rel="prefetch" href="/assets/js/18.3ce10c23.js"><link rel="prefetch" href="/assets/js/19.79ff5d03.js"><link rel="prefetch" href="/assets/js/20.88af7998.js"><link rel="prefetch" href="/assets/js/4.43aa462b.js"><link rel="prefetch" href="/assets/js/5.02b92482.js"><link rel="prefetch" href="/assets/js/6.a2c21cbe.js"><link rel="prefetch" href="/assets/js/7.edee1b09.js"><link rel="prefetch" href="/assets/js/8.760acf12.js"><link rel="prefetch" href="/assets/js/9.26a8aedf.js">
    <link rel="stylesheet" href="/assets/css/0.styles.64f7ac41.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo.png" alt="高分云前端文档" class="logo"> <span class="site-name can-hide">高分云前端文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link router-link-active">
  主页
</a></div><div class="nav-item"><a href="https://github.com/wgjh5" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/wgjh5" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link router-link-active">
  主页
</a></div><div class="nav-item"><a href="https://github.com/wgjh5" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/wgjh5" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/docs/vue-cli3.0打包之后去掉打印.html" class="sidebar-link">vue-cli3.0打包之后去掉打印</a></li><li><a href="/docs/vue自定义loading组件以及相关用法.html" class="sidebar-link">自定义 loading 组件</a></li><li><a href="/docs/获取图片相对坐标.html" class="sidebar-link">获取图片相对坐标</a></li><li><a href="/docs/解决全朗e家白屏问题.html" class="sidebar-link">解决全朗e家白屏问题</a></li><li><a href="/docs/解决element-message弹出多次的问题.html" class="sidebar-link">解决element-message弹出多次的问题</a></li><li><a href="/docs/electron和electron-vue的简单介绍.html" class="sidebar-link">electron和electron-vue的简单介绍</a></li><li><a href="/docs/vue-element-admin学习总结.html" class="active sidebar-link">vue-element-admin学习总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/vue-element-admin学习总结.html#api" class="sidebar-link">api</a></li><li class="sidebar-sub-header"><a href="/docs/vue-element-admin学习总结.html#封装-axios" class="sidebar-link">封装 axios</a></li><li class="sidebar-sub-header"><a href="/docs/vue-element-admin学习总结.html#components" class="sidebar-link">components</a></li><li class="sidebar-sub-header"><a href="/docs/vue-element-admin学习总结.html#store" class="sidebar-link">store</a></li><li class="sidebar-sub-header"><a href="/docs/vue-element-admin学习总结.html#icon-图标的使用方式" class="sidebar-link">icon 图标的使用方式</a></li><li class="sidebar-sub-header"><a href="/docs/vue-element-admin学习总结.html#_1-本地开发环境" class="sidebar-link">1. 本地开发环境</a></li><li class="sidebar-sub-header"><a href="/docs/vue-element-admin学习总结.html#_2-上线正式环境" class="sidebar-link">2. 上线正式环境</a></li><li class="sidebar-sub-header"><a href="/docs/vue-element-admin学习总结.html#_3-集成测试环境" class="sidebar-link">3. 集成测试环境</a></li><li class="sidebar-sub-header"><a href="/docs/vue-element-admin学习总结.html#_1-路由权限" class="sidebar-link">1. 路由权限</a></li><li class="sidebar-sub-header"><a href="/docs/vue-element-admin学习总结.html#_2-按钮级别权限控制" class="sidebar-link">2. 按钮级别权限控制</a></li><li class="sidebar-sub-header"><a href="/docs/vue-element-admin学习总结.html#_1-用法" class="sidebar-link">1. 用法：</a></li></ul></li><li><a href="/docs/解决vue-element-admin Tags-view标签刷新消失问题.html" class="sidebar-link">解决vue-element-admin Tags-view标签刷新消失问题</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-element-admin"><a href="#vue-element-admin" class="header-anchor">#</a> vue-element-admin</h1> <p><a href="https://github.com/varHarrie/Dawn-Blossoms/issues/10" target="_blank" rel="noopener noreferrer">vscode 插件和配置推荐<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>这是一篇对 vue-element-admin 的学习总结文章。</p></blockquote> <p><a href="https://panjiachen.github.io/vue-element-admin-site/zh/" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h1 id="目录结构"><a href="#目录结构" class="header-anchor">#</a> 目录结构</h1> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>├── build                      <span class="token comment"># 构建相关</span>
├── mock                       <span class="token comment"># 项目mock 模拟数据</span>
├── plop-templates             <span class="token comment"># 基本模板</span>
├── public                     <span class="token comment"># 静态资源</span>
│   │── favicon.ico            <span class="token comment"># favicon图标</span>
│   └── index.html             <span class="token comment"># html模板</span>
├── src                        <span class="token comment"># 源代码</span>
│   ├── api                    <span class="token comment"># 所有请求</span>
│   ├── assets                 <span class="token comment"># 主题 字体等静态资源</span>
│   ├── components             <span class="token comment"># 全局公用组件</span>
│   ├── directive              <span class="token comment"># 全局指令</span>
│   ├── filters                <span class="token comment"># 全局 filter</span>
│   ├── icons                  <span class="token comment"># 项目所有 svg icons</span>
│   ├── lang                   <span class="token comment"># 国际化 language</span>
│   ├── layout                 <span class="token comment"># 全局 layout</span>
│   ├── router                 <span class="token comment"># 路由</span>
│   ├── store                  <span class="token comment"># 全局 store管理</span>
│   ├── styles                 <span class="token comment"># 全局样式</span>
│   ├── utils                  <span class="token comment"># 全局公用方法</span>
│   ├── vendor                 <span class="token comment"># 公用vendor</span>
│   ├── views                  <span class="token comment"># views 所有页面</span>
│   ├── App.vue                <span class="token comment"># 入口页面</span>
│   ├── main.js                <span class="token comment"># 入口文件 加载组件 初始化等</span>
│   └── permission.js          <span class="token comment"># 权限管理</span>
├── tests                      <span class="token comment"># 测试</span>
├── .env.xxx                   <span class="token comment"># 环境变量配置</span>
├── .eslintrc.js               <span class="token comment"># eslint 配置项</span>
├── .babelrc                   <span class="token comment"># babel-loader 配置</span>
├── .travis.yml                <span class="token comment"># 自动化CI配置</span>
├── vue.config.js              <span class="token comment"># vue-cli 配置</span>
├── postcss.config.js          <span class="token comment"># postcss 配置</span>
└── package.json               <span class="token comment"># package.json</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h1 id="开始开发"><a href="#开始开发" class="header-anchor">#</a> 开始开发</h1> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 克隆项目</span>
<span class="token function">git</span> clone https://github.com/PanJiaChen/vue-element-admin.git

<span class="token comment"># 进入项目目录</span>
<span class="token builtin class-name">cd</span> vue-element-admin

<span class="token comment"># 安装依赖</span>
<span class="token function">npm</span> <span class="token function">install</span>

<span class="token comment"># 建议不要直接使用 cnpm 安装依赖，会有各种诡异的 bug。可以通过如下操作解决 npm 下载速度慢的问题</span>
<span class="token function">npm</span> <span class="token function">install</span> --registry<span class="token operator">=</span>https://registry.npm.taobao.org

<span class="token comment"># 启动服务</span>
<span class="token function">npm</span> run dev

<span class="token comment">#发布</span>

<span class="token comment">#正式环境</span>
<span class="token function">npm</span> run build:prod

<span class="token comment">#集成环境</span>
<span class="token function">npm</span> run sit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><blockquote><p>如果<code>node-sass</code>安装报错的话，可以重试<code>npm install node-sass</code>，如果还是不行的话，可以<code>npm install --registry=https://registry.npm.taobao.org/</code>，再安装；实在不行的话用<code>cnpm install node-sass</code>安装这个包感觉也没关系，虽然文档不建议，但是这个包用<code>cnpm</code>肯定是没问题的</p></blockquote> <p>node-sass报错可参考链接：https://github.com/PanJiaChen/vue-element-admin/issues/24</p> <h1 id="一、src-目录"><a href="#一、src-目录" class="header-anchor">#</a> 一、src 目录</h1> <blockquote><p>views 和 api 两个模块一一对应，从而方便维护</p> <p>api：请求接口文件夹</p> <p>views：页面组件文件夹</p></blockquote> <h2 id="api"><a href="#api" class="header-anchor">#</a> api</h2> <blockquote><p>一个<code>.js</code>对应一个<code>views文件夹</code>里面的一个模块</p></blockquote> <p>例如：</p> <p><img src="/assets/img/api-views.691e98b4.png" alt="api-views"></p> <p>api 里面的<code>login.js</code>，对应的是 views 里面的<code>login</code>文件夹，如果有公共模块就单独放置就好</p> <h3 id="用法"><a href="#用法" class="header-anchor">#</a> 用法：</h3> <h4 id="_1-先在-src-api-新建xxx-js-例如bind-js"><a href="#_1-先在-src-api-新建xxx-js-例如bind-js" class="header-anchor">#</a> 1. 先在/src/api 新建<code>xxx.js</code>，例如<code>bind.js</code></h4> <h4 id="_2-引入"><a href="#_2-引入" class="header-anchor">#</a> 2. 引入</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;@/utils/request&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> qs <span class="token keyword">from</span> <span class="token string">&quot;qs&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 解除管控-列表页</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">deleteClassPlateCtrlByBatch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ctrlSystem/deleteClassPlateCtrlByBatch</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_3-使用"><a href="#_3-使用" class="header-anchor">#</a> 3. 使用</h4> <h5 id="_3-1-引入"><a href="#_3-1-引入" class="header-anchor">#</a> 3.1 引入</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> deleteStudentPlateCtrlByBatch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/api/bindManage&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="_3-2-函数中使用"><a href="#_3-2-函数中使用" class="header-anchor">#</a> 3.2 函数中使用</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">deleCtro</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">let</span> defaultBaseInfo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>user<span class="token punctuation">.</span>defaultBaseInfo<span class="token punctuation">;</span>
     <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
        interUser<span class="token operator">:</span> <span class="token string">&quot;runLfb&quot;</span><span class="token punctuation">,</span>
        interPwd<span class="token operator">:</span> <span class="token function">hex_md5</span><span class="token punctuation">(</span><span class="token number">1234578</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        operateAccountNo<span class="token operator">:</span> defaultBaseInfo<span class="token punctuation">.</span>operateAccountNo<span class="token punctuation">,</span>
        belongSchoolId<span class="token operator">:</span> defaultBaseInfo<span class="token punctuation">.</span>belongSchoolId<span class="token punctuation">,</span>
        schoolId<span class="token operator">:</span> queryObj<span class="token punctuation">.</span>schoolId<span class="token punctuation">,</span>
        classId<span class="token operator">:</span> queryObj<span class="token punctuation">.</span>classId<span class="token punctuation">,</span>
        surfacePlateBindRequestVoList<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>classIdList<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
        requestJson<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">deleteStudentPlateCtrlByBatch</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;deleteClassPlateCtrlByBatch&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="封装-axios"><a href="#封装-axios" class="header-anchor">#</a> 封装 axios</h2> <h4 id="_1-src-utils-request-js"><a href="#_1-src-utils-request-js" class="header-anchor">#</a> 1. /src/utils/request.js</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> MessageBox<span class="token punctuation">,</span> Message <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;element-ui&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&quot;@/store&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getToken <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/utils/auth&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">&quot;../router&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Loading <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;element-ui&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Cookies <span class="token keyword">from</span> <span class="token string">&quot;js-cookie&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// create an axios instance</span>
<span class="token keyword">const</span> service <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  baseURL<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_BASE_API</span><span class="token punctuation">,</span> <span class="token comment">// url = base url + request url</span>
  <span class="token comment">// withCredentials: true, // send cookies when cross-domain requests</span>
  timeout<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span> <span class="token comment">// request timeout</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// //========================================================token ======================================</span>
<span class="token keyword">var</span> loading <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> <span class="token comment">//定义loading变量</span>

<span class="token keyword">function</span> <span class="token function">startLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//使用Element loading-start 方法</span>
  loading <span class="token operator">=</span> Loading<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    lock<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// text: '加载中……',</span>
    background<span class="token operator">:</span> <span class="token string">&quot;rgba(0, 0, 0, 0)&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">endLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//使用Element loading-close 方法</span>
  loading<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 刷新token的过期时间判断</span>
<span class="token keyword">function</span> <span class="token function">isRefreshTokenExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> oData <span class="token operator">=</span> store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>getTokenTime<span class="token punctuation">;</span> <span class="token comment">// 这是在登陆时候保存的时间戳</span>
  <span class="token keyword">const</span> nDta <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> stamp <span class="token operator">=</span> nDta <span class="token operator">-</span> oData<span class="token punctuation">;</span> <span class="token comment">// 相差的微秒数</span>
  <span class="token comment">// const seconds = parseInt((stamp % (1000 * 60 * 60)) / 1000)  错误的计算，秒数差永远&lt;3600</span>
  <span class="token keyword">const</span> seconds <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>stamp <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    seconds <span class="token operator">&gt;=</span> <span class="token punctuation">(</span>store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>getTokenUsable <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span>
    seconds <span class="token operator">&lt;</span> store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>getTokenUsable
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// return false</span>
<span class="token punctuation">}</span>
<span class="token comment">// 刷新token</span>
<span class="token keyword">function</span> <span class="token function">getRefreshToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 刷新token 注意这里用到的service</span>
  <span class="token keyword">return</span> service<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/public/regenerationToken&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 是否正在刷新的标志</span>
window<span class="token punctuation">.</span>isRefreshing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">// 存储请求的数组</span>
<span class="token keyword">let</span> refreshSubscribers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/* 将所有的请求都push到数组中*/</span>
<span class="token keyword">function</span> <span class="token function">subscribeTokenRefresh</span><span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  refreshSubscribers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 数组中的请求得到新的token之后自执行，用新的token去请求数据</span>
<span class="token keyword">function</span> <span class="token function">onRrefreshed</span><span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  refreshSubscribers<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 删除cookie</span>
<span class="token keyword">function</span> <span class="token function">removeCookie</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Cookies<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Cookies<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// request interceptor</span>
service<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">startLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> url <span class="token operator">=</span> config<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
    <span class="token comment">// 解决问题：axios不会对url中的功能性字符进行编码，手动编码</span>
    <span class="token comment">// get参数编码</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">&quot;get&quot;</span> <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      url <span class="token operator">+=</span> <span class="token string">&quot;?&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">of</span> keys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        url <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>params<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      url <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> url<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      config<span class="token punctuation">.</span>params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    config<span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>

    <span class="token keyword">const</span> accessToken <span class="token operator">=</span> store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>getAccessToken<span class="token punctuation">;</span> <span class="token comment">// 本地保存的token</span>
    <span class="token keyword">const</span> refreshToken <span class="token operator">=</span> store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>getRefreshToken<span class="token punctuation">;</span> <span class="token comment">// 本地保存的token</span>
    <span class="token comment">/* 判断token是否存在*/</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>accessToken <span class="token operator">&amp;&amp;</span> accessToken <span class="token operator">!=</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">/* 在请求头中添加token类型、token*/</span>
      config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>access_token <span class="token operator">=</span> accessToken<span class="token punctuation">;</span>
      config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>client_type <span class="token operator">=</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>user<span class="token punctuation">.</span>client_type<span class="token punctuation">;</span>
      <span class="token comment">// config.url = config.url + '?t=' + (new Date()).getTime().toString(); // 清楚缓存</span>
      <span class="token comment">/* 判断token是否将要过期 */</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>
        <span class="token function">isRefreshTokenExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        config<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;public/regenerationToken&quot;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span>
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>isRefreshing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// /*判断是否正在刷新*/</span>
          window<span class="token punctuation">.</span>isRefreshing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
          <span class="token comment">/* 发起刷新token的请求*/</span>
          <span class="token comment">// config.headers.Authorization = ''</span>
          <span class="token function">getRefreshToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token comment">/* 把请求(token)=&gt;{....}都push到一个数组中*/</span>
          <span class="token keyword">const</span> retry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">/* (token) =&gt; {...}这个函数就是回调函数*/</span>
            <span class="token function">subscribeTokenRefresh</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token comment">// config.headers.common['Authorization'] = 'bearer ' + token;</span>
              config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>access_token <span class="token operator">=</span> token<span class="token punctuation">;</span>
              <span class="token comment">/* 将请求挂起*/</span>
              <span class="token function">resolve</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> retry<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> config<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\/public\/regenerationToken$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>refresh_token <span class="token operator">=</span> refreshToken<span class="token punctuation">;</span>
        <span class="token keyword">return</span> config<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> config<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> config<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// response interceptor</span>
service<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token comment">/**
   * 根据后端的code码，做一些操作
   */</span>
  <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">endLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token comment">// 没有身份令牌或过期</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">11002</span> <span class="token operator">||</span> res<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">11001</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setAccessToken&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setRefreshToken&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setTokenTime&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setTokenUsable&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      localStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">removeCookie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">Message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        message<span class="token operator">:</span> <span class="token string">&quot;登录信息失效，请重新登录&quot;</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
        duration<span class="token operator">:</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// alert(response.config.url)</span>
    <span class="token comment">// console.log(response.config.url, 'response.config.url')</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      <span class="token punctuation">(</span>response<span class="token punctuation">.</span>config<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\/user\/phoneLogin$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> res<span class="token punctuation">.</span>flag<span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token punctuation">(</span>response<span class="token punctuation">.</span>config<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\/user\/registerByVerificationCode$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span>
        res<span class="token punctuation">.</span>flag<span class="token punctuation">)</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setAccessToken&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>access_token<span class="token punctuation">)</span><span class="token punctuation">;</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setRefreshToken&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>refresh_token<span class="token punctuation">)</span><span class="token punctuation">;</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setTokenTime&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setTokenUsable&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>token_usable<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>
      response<span class="token punctuation">.</span>config<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\/public\/regenerationToken$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setAccessToken&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>access_token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setRefreshToken&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>refresh_token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setTokenTime&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setTokenUsable&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>token_usable<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">onRrefreshed</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>access_token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        window<span class="token punctuation">.</span>isRefreshing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        refreshSubscribers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">/* 清除本地保存的*/</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setAccessToken&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setRefreshToken&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setTokenTime&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;user/setTokenUsable&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">removeCookie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          message<span class="token operator">:</span> <span class="token string">&quot;登录信息失效，请重新登录&quot;</span><span class="token punctuation">,</span>
          type<span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
          duration<span class="token operator">:</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Vue.prototype.$log4b.error(&quot;响应错误&quot;+error.config.url+&quot;错误信息&quot;+JSON.stringify(error) )</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;err&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// for debug</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">400</span><span class="token operator">:</span>
          error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;请求错误(400)&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">401</span><span class="token operator">:</span>
          <span class="token keyword">return</span> history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">403</span><span class="token operator">:</span>
          error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;拒绝访问(403)&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">404</span><span class="token operator">:</span>
          error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;请求出错(404)&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">408</span><span class="token operator">:</span>
          error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;请求超时(408)&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">500</span><span class="token operator">:</span>
          error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;服务器错误(500)&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">501</span><span class="token operator">:</span>
          error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;服务未实现(501)&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">502</span><span class="token operator">:</span>
          error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;网络错误(502)&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">503</span><span class="token operator">:</span>
          error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;服务不可用(503)&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">504</span><span class="token operator">:</span>
          error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;网络超时(504)&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">505</span><span class="token operator">:</span>
          error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;HTTP版本不受支持(505)&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
          error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">连接出错(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">Message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        message<span class="token operator">:</span> error<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
        duration<span class="token operator">:</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> service<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br></div></div><h2 id="components"><a href="#components" class="header-anchor">#</a> components</h2> <blockquote><p>components 放置的都是全局公用的一些组件，简单来说就是多个页面能用到的，不只是你当前页面，如上传组件；一些页面级的组件建议还是放在各自 views 文件下，方便管理。</p></blockquote> <h2 id="store"><a href="#store" class="header-anchor">#</a> store</h2> <blockquote><p>用来写 vuex</p></blockquote> <h3 id="用法-2"><a href="#用法-2" class="header-anchor">#</a> 用法：</h3> <h5 id="_1-store-index-js"><a href="#_1-store-index-js" class="header-anchor">#</a> 1. ./store/index.js</h5> <blockquote><p>vuex-along：解决 vuex 刷新消失问题，周下载量 215</p> <p><a href="https://www.npmjs.com/package/vuex-along" target="_blank" rel="noopener noreferrer">vuex-along 使用文档地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>vuex-persistedstate：解决 vuex 刷新消失问题，周下载量 10w+</p> <p><a href="https://www.jianshu.com/p/7fb432e7594e" target="_blank" rel="noopener noreferrer">vuex-persistedstate 使用文档地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>后续建议使用<code>vuex-persistedstate</code></p></blockquote> <ul><li>vuex-along 周下载量</li></ul> <p><img src="/assets/img/image-20201117093206985.fcb45d63.png" alt="vuex-along周下载量"></p> <ul><li>vuex-persistedstate 周下载量</li></ul> <p><img src="/assets/img/image-20201117093415399.04a44743.png" alt="vuex-persistedstate周下载量"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> getters <span class="token keyword">from</span> <span class="token string">&quot;./getters&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> createVuexAlong <span class="token keyword">from</span> <span class="token string">&quot;vuex-along&quot;</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// https://webpack.js.org/guides/dependency-management/#requirecontext</span>
<span class="token keyword">const</span> modulesFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">&quot;./modules&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// you do not need `import app from './modules/app'`</span>
<span class="token comment">// it will auto require all vuex module from modules file</span>
<span class="token keyword">const</span> modules <span class="token operator">=</span> modulesFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">modules<span class="token punctuation">,</span> modulePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// set './app.js' =&gt; 'app'</span>
  <span class="token keyword">const</span> moduleName <span class="token operator">=</span> modulePath<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\.\/(.*)\.\w+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">&quot;$1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token function">modulesFiles</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  modules<span class="token punctuation">[</span>moduleName<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">.</span>default<span class="token punctuation">;</span>
  <span class="token keyword">return</span> modules<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  modules<span class="token punctuation">,</span>
  getters<span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">createVuexAlong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h5 id="_2-0-在-store-modules-新建xxx-js-例如-bind-js"><a href="#_2-0-在-store-modules-新建xxx-js-例如-bind-js" class="header-anchor">#</a> 2.0. 在/store/modules/新建<code>xxx.js</code>，例如，<code>bind.js</code></h5> <p><img src="data:image/png;base64,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" alt="image-20201116174735866"></p> <h5 id="_2-1-bind-js-代码"><a href="#_2-1-bind-js-代码" class="header-anchor">#</a> 2.1. bind.js 代码：</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
  bindFilter<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token comment">//筛选条件缓存</span>
  detailRouter<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//是否是详情页回来的</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mutations <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">bindFilter_Fun</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>bindFilter <span class="token operator">=</span> data<span class="token punctuation">;</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;bindFilter&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//缓存在localStorage里面，解决vuex刷新消失问题</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">detailRouter_Fun</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>detailRouter <span class="token operator">=</span> data<span class="token punctuation">;</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;detailRouter&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">bindFilter</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> commit<span class="token punctuation">,</span> state <span class="token punctuation">}</span><span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;bindFilter_Fun&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">detailRouter</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> commit<span class="token punctuation">,</span> state <span class="token punctuation">}</span><span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;detailRouter_Fun&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  namespaced<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  state<span class="token punctuation">,</span>
  mutations<span class="token punctuation">,</span>
  actions<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h5 id="_3-store-getters-js"><a href="#_3-store-getters-js" class="header-anchor">#</a> 3. /store/getters.js</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> getters <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 绑定管理筛选数据</span>
  <span class="token function-variable function">getBindFilter</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    state<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>bindFilter <span class="token operator">||</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;bindFilter&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getDetailRouter</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    state<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>detailRouter <span class="token operator">||</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;detailRouter&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> getters<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="_4-组件里面的用法"><a href="#_4-组件里面的用法" class="header-anchor">#</a> 4.组件里面的用法</h5> <blockquote><p>更多方法请查看：https://www.jianshu.com/p/0f13a6bec687</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>存入数据：this.$store.dispatch(&quot;bind/detailRouter&quot;, false)
获取数据：this.$store.getters.getDetailRouter
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="_5-namespaced"><a href="#_5-namespaced" class="header-anchor">#</a> 5.namespaced</h5> <blockquote><p>vuex 中的 store 分模块管理，需要在 store 的 index.js 中引入各个模块，为了解决不同模块命名冲突的问题，将不同模块的 namespaced:true，之后在不同页面中引入 getter、actions、mutations 时，需要加上所属的模块名，相反，如果 namespaced:false 就是正常使用不用加模块名字；</p></blockquote> <p><a href="https://www.jianshu.com/p/0f13a6bec687" target="_blank" rel="noopener noreferrer">文档链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="icon-图标的使用方式"><a href="#icon-图标的使用方式" class="header-anchor">#</a> icon 图标的使用方式</h2> <blockquote><p>把下载好的图标放入<code>/src/icons/svg/</code>文件夹</p></blockquote> <h3 id="_1-使用方式"><a href="#_1-使用方式" class="header-anchor">#</a> 1. 使用方式</h3> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg-icon</span> <span class="token attr-name">icon-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> // icon-class 为 icon 的名字
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-改变颜色"><a href="#_2-改变颜色" class="header-anchor">#</a> 2. 改变颜色</h3> <blockquote><p><code>svg-icon</code> 默认会读取其父级的 color <code>fill: currentColor;</code></p> <p>你可以改变父级的<code>color</code>或者直接改变<code>fill</code>的颜色即可。</p></blockquote> <p><a href="https://juejin.im/post/6844903517564436493" target="_blank" rel="noopener noreferrer">相关文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h1 id="二、layout布局"><a href="#二、layout布局" class="header-anchor">#</a> 二、layout布局</h1> <blockquote><p>这里简单看一下layout的布局，方便以后好修改；</p> <p>简单来说就是app.vue里面包含着layout，layout又包含着TagsView，sideBar，AppMain；然后我们写的东西都是在AppMain里面的</p></blockquote> <ul><li>app.vue
<ul><li>layout
<ul><li>TagsView</li> <li>sideBar</li> <li>AppMain (内容容器)</li></ul></li></ul></li></ul> <p><img src="/assets/img/layout.41a0b0a7.png" alt="layout"></p> <h1 id="三、环境变量配置"><a href="#三、环境变量配置" class="header-anchor">#</a> 三、环境变量配置</h1> <h2 id="_1-本地开发环境"><a href="#_1-本地开发环境" class="header-anchor">#</a> 1. 本地开发环境</h2> <blockquote><p>.env.development---这个对应本地地址打包环境</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code># just a flag
<span class="token constant">ENV</span> <span class="token operator">=</span> <span class="token string">'development'</span>

# base api
#<span class="token constant">VUE_APP_BASE_API</span> <span class="token operator">=</span> <span class="token string">'/dev-api'</span>

#代理服务器api
#<span class="token constant">VUE_APP_BASE_API</span> <span class="token operator">=</span> <span class="token string">'/api'</span> 接口地址

#不用代理服务器api 接口地址
<span class="token constant">VUE_APP_BASE_API</span> <span class="token operator">=</span> <span class="token string">'http://119.23.xxx.xxx:9001/service-soa'</span>

# vue<span class="token operator">-</span>cli uses the <span class="token constant">VUE_CLI_BABEL_TRANSPILE_MODULES</span> environment variable<span class="token punctuation">,</span>
# to control whether the babel<span class="token operator">-</span>plugin<span class="token operator">-</span>dynamic<span class="token operator">-</span><span class="token keyword">import</span><span class="token operator">-</span>node plugin is enabled<span class="token punctuation">.</span>
# It only does one thing by converting all <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token punctuation">)</span> to <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
# This configuration can significantly increase the speed <span class="token keyword">of</span> hot updates<span class="token punctuation">,</span>
# when you have a large number <span class="token keyword">of</span> pages<span class="token punctuation">.</span>
# Detail<span class="token operator">:</span>  https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>vuejs<span class="token operator">/</span>vue<span class="token operator">-</span>cli<span class="token operator">/</span>blob<span class="token operator">/</span>dev<span class="token operator">/</span>packages<span class="token operator">/</span>@vue<span class="token operator">/</span>babel<span class="token operator">-</span>preset<span class="token operator">-</span>app<span class="token operator">/</span>index<span class="token punctuation">.</span>js
#开发环境不使用路由懒加载
<span class="token constant">VUE_CLI_BABEL_TRANSPILE_MODULES</span> <span class="token operator">=</span> <span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="_2-上线正式环境"><a href="#_2-上线正式环境" class="header-anchor">#</a> 2. 上线正式环境</h2> <blockquote><p>.env.production------这个对应正式环境</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code># just a flag
<span class="token constant">ENV</span> <span class="token operator">=</span> <span class="token string">'production'</span>

# base api 接口地址
<span class="token constant">VUE_APP_BASE_API</span> <span class="token operator">=</span> <span class="token string">'http://119.23.xxx.xx:8080/service-soa'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_3-集成测试环境"><a href="#_3-集成测试环境" class="header-anchor">#</a> 3. 集成测试环境</h2> <blockquote><p>.env.sit------这个对应正式环境</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>#
<span class="token constant">NODE_ENV</span> <span class="token operator">=</span> production

# just a flag
<span class="token constant">ENV</span> <span class="token operator">=</span> <span class="token string">'sit'</span>

# base api 接口地址
<span class="token constant">VUE_APP_BASE_API</span> <span class="token operator">=</span> <span class="token string">'http://119.23.xxx.71:9001/service-soa'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h1 id="四、-vue-config-js"><a href="#四、-vue-config-js" class="header-anchor">#</a> 四、 vue.config.js</h1> <blockquote><p><a href="https://www.jianshu.com/p/a8f0e1dfa825" target="_blank" rel="noopener noreferrer">相关文档-My<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/weixin_41404460/article/details/94717481" target="_blank" rel="noopener noreferrer">相关文档-Other<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> defaultSettings <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./src/settings.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> defaultSettings<span class="token punctuation">.</span>title <span class="token operator">||</span> <span class="token string">&quot;vue Element Admin&quot;</span><span class="token punctuation">;</span> <span class="token comment">// page title</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>port <span class="token operator">||</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>npm_config_port <span class="token operator">||</span> <span class="token number">9530</span><span class="token punctuation">;</span> <span class="token comment">// 端口号 port</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  publicPath<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
  outputDir<span class="token operator">:</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">,</span>
  assetsDir<span class="token operator">:</span> <span class="token string">&quot;static&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// lintOnSave: process.env.NODE_ENV === 'development',</span>
  lintOnSave<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  productionSourceMap<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 热加载</span>
    port<span class="token operator">:</span> port<span class="token punctuation">,</span>
    https<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// false关闭https，true为开启</span>
    <span class="token comment">// open: true,</span>
    overlay<span class="token operator">:</span> <span class="token punctuation">{</span>
      warnings<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      errors<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// before: require('./mock/mock-server.js'),</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;/api&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">&quot;http://119.23.xxx.xxx:9001/service-soa&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// 在本地会创建一个虚拟服务端，然后发送请求的数据，并同时接收请求的数据，这样服务端和服务端进行数据的交互就不会有跨域问题</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        ws<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 替换target中的请求地址，也就是说以后你在请求http://api.jisuapi.com/XXXXX这个地址的时候直接写成/api/xxx即可</span>
          <span class="token string">&quot;^/api&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token string">&quot;/qq&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">&quot;https://xxx.qq.com/oauth2.0&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// 在本地会创建一个虚拟服务端，然后发送请求的数据，并同时接收请求的数据，这样服务端和服务端进行数据的交互就不会有跨域问题</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        ws<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 替换target中的请求地址，也就是说以后你在请求http://api.jisuapi.com/XXXXX这个地址的时候直接写成/api/xxx即可</span>
          <span class="token string">&quot;^/qq&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">&quot;/oss&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">&quot;http://xxx.xxx.aliyuncs.com&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// 在本地会创建一个虚拟服务端，然后发送请求的数据，并同时接收请求的数据，这样服务端和服务端进行数据的交互就不会有跨域问题</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        ws<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 替换target中的请求地址，也就是说以后你在请求http://api.jisuapi.com/XXXXX这个地址的时候直接写成/api/xxx即可</span>
          <span class="token string">&quot;^/oss&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  configureWebpack<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// provide the app's title in webpack's name field, so that</span>
    <span class="token comment">// it can be accessed in index.html to inject the correct title.</span>
    name<span class="token operator">:</span> name<span class="token punctuation">,</span>
    resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
      alias<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;@&quot;</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">chainWebpack</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;preload&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TODO: need test</span>
    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;prefetch&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TODO: need test</span>

    <span class="token comment">// set svg-sprite-loader</span>
    config<span class="token punctuation">.</span>module<span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>exclude<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;src/icons&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>module
      <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">&quot;icons&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.svg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>include<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;src/icons&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;svg-sprite-loader&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">&quot;svg-sprite-loader&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        symbolId<span class="token operator">:</span> <span class="token string">&quot;icon-[name]&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// set preserveWhitespace</span>
    config<span class="token punctuation">.</span>module
      <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">&quot;vue&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;vue-loader&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">&quot;vue-loader&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        options<span class="token punctuation">.</span>compilerOptions<span class="token punctuation">.</span>preserveWhitespace <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> options<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    config
      <span class="token comment">// https://webpack.js.org/configuration/devtool/#development</span>
      <span class="token punctuation">.</span><span class="token function">when</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        config<span class="token punctuation">.</span><span class="token function">devtool</span><span class="token punctuation">(</span><span class="token string">&quot;cheap-source-map&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>

    config<span class="token punctuation">.</span><span class="token function">when</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      config
        <span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">&quot;ScriptExtHtmlWebpackPlugin&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token string">&quot;html&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;script-ext-html-webpack-plugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token comment">// `runtime` must same as runtimeChunk name. default is `runtime`</span>
            inline<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">runtime\..*\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      config<span class="token punctuation">.</span>optimization<span class="token punctuation">.</span><span class="token function">splitChunks</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        chunks<span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
        cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
          libs<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">&quot;chunk-libs&quot;</span><span class="token punctuation">,</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            priority<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
            chunks<span class="token operator">:</span> <span class="token string">&quot;initial&quot;</span><span class="token punctuation">,</span> <span class="token comment">// only package third parties that are initially dependent</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          elementUI<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">&quot;chunk-elementUI&quot;</span><span class="token punctuation">,</span> <span class="token comment">// split elementUI into a single package</span>
            priority<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">// the weight needs to be larger than libs and app or it will be packaged into libs or app</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]_?element-ui(.*)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// in order to adapt to cnpm</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          commons<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">&quot;chunk-commons&quot;</span><span class="token punctuation">,</span>
            test<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;src/components&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// can customize your rules</span>
            minChunks<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">//  minimum common number</span>
            priority<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            reuseExistingChunk<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      config<span class="token punctuation">.</span>optimization<span class="token punctuation">.</span><span class="token function">runtimeChunk</span><span class="token punctuation">(</span><span class="token string">&quot;single&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br></div></div><h1 id="五、-package-json"><a href="#五、-package-json" class="header-anchor">#</a> 五、 package.json</h1> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-element-admin&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4.2.1&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A magical vue admin. An out-of-box UI solution for enterprise applications. Newest development stack of vue. Lots of awesome features&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Pan &lt;panfree23@gmail.com&gt;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MIT&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service serve --open&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build --mode sit&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;prod&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build --mode production&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build:prod&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build:stage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build --mode staging&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;preview&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node build/index.js --preview&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint --ext .js,.vue src&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test:unit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jest --clearCache &amp;&amp; vue-cli-service test:unit&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test:ci&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run lint &amp;&amp; npm run test:unit&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;svgo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;svgo -f src/icons/svg --config=src/icons/svgo.yml&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;new&quot;</span><span class="token operator">:</span> <span class="token string">&quot;plop&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;src/**/*.{js,vue}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;eslint --fix&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;git add&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;dashboard&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;element-ui&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;boilerplate&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;admin-template&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;management-system&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;repository&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;git&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;git+https://github.com/PanJiaChen/vue-element-admin.git&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;bugs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://github.com/PanJiaChen/vue-element-admin/issues&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@fortawesome/fontawesome-svg-core&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.2.29&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@fortawesome/free-brands-svg-icons&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.13.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@fortawesome/free-regular-svg-icons&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.13.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@fortawesome/free-solid-svg-icons&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.13.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@fortawesome/vue-fontawesome&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.1.10&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;arr2tree&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;axios&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.18.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;clipboard&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.0.4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;codemirror&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5.45.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;crypto-js&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;driver.js&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.9.5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dropzone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5.5.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;echarts&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4.2.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;element-ui&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.13.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;file-saver&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fingerprintjs2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.1.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fundebug-javascript&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.4.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fundebug-vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fuse.js&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.4.4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;js-cookie&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;jsonlint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.6.3&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;jszip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.2.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;kindeditor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.1.10&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moment&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.27.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;normalize.css&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;nprogress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;path-to-regexp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.4.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;qrcode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.4.4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;qrcodejs2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;screenfull&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;script-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.7.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;showdown&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.9.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sortablejs&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.8.4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;tui-editor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.3.3&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.6.10&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vue-count-to&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.13&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vue-router&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.0.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vue-splitpane&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vuedraggable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.20.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vuex&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.1.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vuex-along&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.2.11&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;wangeditor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.1.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;xlsx&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.14.1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@babel/core&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@babel/register&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vue/cli-plugin-babel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.5.3&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vue/cli-plugin-eslint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.9.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vue/cli-plugin-unit-jest&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.5.3&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vue/cli-service&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.5.3&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vue/test-utils&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0-beta.29&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;autoprefixer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^9.5.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;babel-core&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7.0.0-bridge.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;babel-eslint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;babel-jest&quot;</span><span class="token operator">:</span> <span class="token string">&quot;23.6.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;chalk&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.4.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;chokidar&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.1.5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;connect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.6.6&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;eslint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5.15.3&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;eslint-plugin-vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5.2.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;html-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;husky&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.3.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.1.5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mockjs&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.1-beta3&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;node-sass&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.9.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;plop&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.3.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;runjs&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.3.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sass-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.1.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;script-ext-html-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.1.3&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;serve-static&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.13.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;svg-sprite-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4.1.3&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;svgo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vue-template-compiler&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.6.10&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;engines&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;node&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&gt;=8.9&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;npm&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&gt;= 3.0.0&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;browserslist&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&gt; 1%&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;last 2 versions&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br></div></div><h1 id="六、权限"><a href="#六、权限" class="header-anchor">#</a> 六、权限</h1> <h2 id="_1-路由权限"><a href="#_1-路由权限" class="header-anchor">#</a> 1. 路由权限</h2> <h4 id="流程"><a href="#流程" class="header-anchor">#</a> 流程：</h4> <blockquote><p>1.登录页面按钮点击
2.vuex 里面的 login 方法被调用
3.vuex 里面的 login 方法被调用 完毕 4.监听路由改变 然后获取当前登录的用户角色 5.获取当前用户信息 获取角色组 并保存登录状态,返回当前角色信息 6.通过 角色 和 所有路由 匹配出对应角色拥有的路由权限 返回路由组
7 将上面获取到的 路由权限 挂载到真实的路由上面去</p></blockquote> <h4 id="路由权限涉及文件"><a href="#路由权限涉及文件" class="header-anchor">#</a> 路由权限涉及文件：</h4> <blockquote><p>/src/views/login/index.vue 登录页面的入口文件</p> <p>/src/store/modules/user.js vuex 的文件 全局方法</p> <p>/src/permission.js 监听路由改变后的 js</p> <p>/src/store/mudules/permission.js 通过 角色返回 登录角色的对应路由列表的方法</p> <p>src/views/permission/components/SwitchRoles.vue 切换角色的文件 这个登录不走 切换角色才会走</p></blockquote> <h4 id="src-router-index-js"><a href="#src-router-index-js" class="header-anchor">#</a> /src/router/index.js</h4> <p>首先路由页面 router:
有 2 个参数</p> <blockquote><p>export const constantRouterMap = [] 为初始路由参数，如登录 首页 404 等共有页面 不需要权限控制的路由
export const asyncRouterMap = []为动态路由 登录成功后 在 router.beforeEach 中根据后端权限 加载不同路由 已展示不同的左侧菜单</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Router<span class="token punctuation">)</span>
<span class="token comment">/* Layout */</span>
<span class="token keyword">import</span> Layout <span class="token keyword">from</span> <span class="token string">'@/layout'</span>
<span class="token comment">/**
 * Note: sub-menu only appear when route children.length &gt;= 1
 * Detail see: https://panjiachen.github.io/vue-element-admin-site/guide/essentials/router-and-nav.html
 *
 * hidden: true                  如果设置为true，则不会在侧边栏中显示该项（默认为false）
 * alwaysShow: true               如果设置为true，将始终显示根菜单
 *                                如果未设置alwaysShow，则当项目有多个子路径时，
                                  *它将变成嵌套模式，否则不显示根菜单
 * redirect: noRedirect           如果set noRedirect将不会在breadcrumb中重定向
 * name:'router-name'             名称由&lt;keep alive&gt;使用（必须设置！！！）
 * meta : {
    roles: ['admin','editor']    控制页面角色（可以设置多个角色）
    title: 'title'               在边栏和面包屑中显示的名称（推荐集）
    icon: 'svg-name'             图标显示在侧栏中
    noCache: true                如果设置为true，则不会缓存该页（默认值为false）
    affix: true                  如果设置为true，则标记将附加在tags视图中
    breadcrumb: false            如果设置为false，则项目将隐藏在breadcrumb中（默认值为true）
    activeMenu: '/example/list'  如果设置路径，侧栏将突出显示您设置的路径
  }
 */</span>

<span class="token comment">/**
 * constantRoutes
 * 无权限的基础路由，所有角色可访问
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> constantRoutes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/login'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/login/login-index.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    hidden<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> Layout<span class="token punctuation">,</span>
    redirect<span class="token operator">:</span> <span class="token string">'/bind-management'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/auth-redirect'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/login/auth-redirect'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    hidden<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/404'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/error-page/404'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    hidden<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/401'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/error-page/401'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    hidden<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/notice'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> Layout<span class="token punctuation">,</span>
    hidden<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">'index'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/noticeManagement/noticeList'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'Notice'</span><span class="token punctuation">,</span>
      meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'消息通知'</span><span class="token punctuation">,</span>
        icon<span class="token operator">:</span> <span class="token string">'guide'</span><span class="token punctuation">,</span>
        noCache<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">]</span>
<span class="token comment">/**
 * asyncRoutes
 * 有权限，权限为admin可以访问
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> asyncRoutes <span class="token operator">=</span> <span class="token punctuation">[</span>

  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/icon'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> Layout<span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">'index'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/icons/index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'Icons'</span><span class="token punctuation">,</span>
      meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'Icons'</span><span class="token punctuation">,</span>
        icon<span class="token operator">:</span> <span class="token string">'icon'</span><span class="token punctuation">,</span>
        noCache<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        roles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'noPremission'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">const</span> strategyManagementRouter <span class="token operator">=</span> <span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">'/strategy-management'</span><span class="token punctuation">,</span>
  component<span class="token operator">:</span> Layout<span class="token punctuation">,</span>
  redirect<span class="token operator">:</span> <span class="token string">'/strategy-management/index'</span><span class="token punctuation">,</span>
  meta<span class="token operator">:</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">'策略管理'</span><span class="token punctuation">,</span>
    icon<span class="token operator">:</span> <span class="token string">'ctrl_icon_strategy'</span><span class="token punctuation">,</span>
    roles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">'/strategy-management/index'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/strategyManagement/index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'strategyManagement'</span><span class="token punctuation">,</span>
      alwaysShow<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'策略管理'</span><span class="token punctuation">,</span>
        icon<span class="token operator">:</span> <span class="token string">'ctrl_icon_strategy'</span><span class="token punctuation">,</span>
        roles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">'/bind-management'</span><span class="token punctuation">,</span>
  component<span class="token operator">:</span> Layout<span class="token punctuation">,</span>
  redirect<span class="token operator">:</span> <span class="token string">'/bind-management/index'</span><span class="token punctuation">,</span>
  meta<span class="token operator">:</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">'绑定管理'</span><span class="token punctuation">,</span>
    icon<span class="token operator">:</span> <span class="token string">'ctrl_icon_bindings'</span><span class="token punctuation">,</span>
    roles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    noCache<span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">'/bind-management/index'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/bindManagement/index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'bindManagement'</span><span class="token punctuation">,</span>
      alwaysShow<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'绑定管理'</span><span class="token punctuation">,</span>
        icon<span class="token operator">:</span> <span class="token string">'ctrl_icon_bindings'</span><span class="token punctuation">,</span>
        roles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        noCache<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">'/bind-management/detail'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/bindManagement/bindDetail'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'bindDetail'</span><span class="token punctuation">,</span>
      hidden<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'班级详情'</span><span class="token punctuation">,</span>
        icon<span class="token operator">:</span> <span class="token string">'ctrl_icon_bindings'</span><span class="token punctuation">,</span>
        roles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        activeMenu<span class="token operator">:</span> <span class="token string">'/bind-management/index'</span><span class="token punctuation">,</span>
        noCache<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 404 page must be placed at the end !!!</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'*'</span><span class="token punctuation">,</span>
    redirect<span class="token operator">:</span> <span class="token string">'/404'</span><span class="token punctuation">,</span>
    hidden<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> <span class="token function-variable function">createRouter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">scrollBehavior</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    y<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token operator">:</span> constantRoutes
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//重新设置路由</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">resetRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newRouter <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  router<span class="token punctuation">.</span>matcher <span class="token operator">=</span> newRouter<span class="token punctuation">.</span>matcher <span class="token comment">// reset router</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br></div></div><h4 id="src-permission-js"><a href="#src-permission-js" class="header-anchor">#</a> /src/permission.js</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">&quot;./router&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&quot;./store&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Message <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;element-ui&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> NProgress <span class="token keyword">from</span> <span class="token string">&quot;nprogress&quot;</span><span class="token punctuation">;</span> <span class="token comment">// progress bar</span>
<span class="token keyword">import</span> <span class="token string">&quot;nprogress/nprogress.css&quot;</span><span class="token punctuation">;</span> <span class="token comment">// progress bar style</span>
<span class="token keyword">import</span> getPageTitle <span class="token keyword">from</span> <span class="token string">&quot;@/utils/get-page-title&quot;</span><span class="token punctuation">;</span>
NProgress<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  showSpinner<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// NProgress Configuration</span>

<span class="token keyword">const</span> whiteList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/auth-redirect&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/dashboard&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// no redirect whitelist</span>
<span class="token keyword">let</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 路由加载进度条</span>
  NProgress<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 设置页面title</span>
  document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token function">getPageTitle</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 确定是否登录</span>
  <span class="token keyword">const</span> hasToken <span class="token operator">=</span> store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>getAccessToken<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>hasToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        path<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      NProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> hasAddRoutes <span class="token operator">=</span>
          store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>addRoutes <span class="token operator">&amp;&amp;</span> store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>addRoutes<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token operator">!</span>hasAddRoutes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> permissionRoutes <span class="token operator">=</span> <span class="token keyword">await</span> store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>
            <span class="token string">&quot;user/queryFuncByRoles&quot;</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//触发权限函数，查询路由、按钮权限</span>
          <span class="token keyword">const</span> buttonCode <span class="token operator">=</span> permissionRoutes<span class="token punctuation">.</span>buttonCode<span class="token punctuation">;</span>
          localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;buttonCode&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>buttonCode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//保存权限按钮到本地</span>
          <span class="token keyword">const</span> accessRoutes <span class="token operator">=</span> <span class="token keyword">await</span> store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>
            <span class="token string">&quot;permission/generateRoutes&quot;</span><span class="token punctuation">,</span>
            permissionRoutes<span class="token punctuation">.</span>sysFuncViewList
          <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取动态路由数组</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>accessRoutes<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">await</span> store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&quot;user/resetToken&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;该账户无可访问权限&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            NProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">next</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/login?redirect=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>to<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;accessRoutes&quot;</span><span class="token punctuation">,</span> accessRoutes<span class="token punctuation">)</span><span class="token punctuation">;</span>
          router<span class="token punctuation">.</span><span class="token function">addRoutes</span><span class="token punctuation">(</span>accessRoutes<span class="token punctuation">)</span><span class="token punctuation">;</span>
          flag<span class="token operator">++</span><span class="token punctuation">;</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>to<span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 删除token，跳转到登录页</span>
        <span class="token keyword">await</span> store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&quot;user/resetToken&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          message<span class="token operator">:</span> error <span class="token operator">||</span> <span class="token string">&quot;出现错误，请稍后再试&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/login?redirect=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>to<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        NProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 未登录去whiteList里面的路由可以去，去别的则跳转登录页</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>whiteList<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>path<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">//没权限的重定向到首页</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/login</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      NProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  NProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br></div></div><h4 id="src-store-mudules-permission-js"><a href="#src-store-mudules-permission-js" class="header-anchor">#</a> /src/store/mudules/permission.js</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/*
 * @Author: your name
 * @Date: 2020-10-27 17:49:08
 * @LastEditTime: 2020-11-18 16:09:40
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: \Git\plate-control-admin\src\store\modules\permission.js
 */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> asyncRoutes<span class="token punctuation">,</span> constantRoutes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/router&quot;</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 通过meta.roles判断是否与当前用户权限匹配
 * 判断传进来的路由（route）里面的meta.roles是否满足'admin'条件，满足返回true，相反false
 * @param roles 权限数组 ['admin']
 * @param route 路由数组
 */</span>
<span class="token keyword">function</span> <span class="token function">hasPermission</span><span class="token punctuation">(</span><span class="token parameter">roles<span class="token punctuation">,</span> route</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>route<span class="token punctuation">.</span>meta <span class="token operator">&amp;&amp;</span> route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>roles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> roles<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">role</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>roles<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 递归过滤异步路由表，返回符合用户角色权限的路由表
 * @param routes asyncRoutes
 * @param roles
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">filterAsyncRoutes</span><span class="token punctuation">(</span><span class="token parameter">routes<span class="token punctuation">,</span> roles</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  routes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">route</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> tmp <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>route <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hasPermission</span><span class="token punctuation">(</span>roles<span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        tmp<span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token function">filterAsyncRoutes</span><span class="token punctuation">(</span>tmp<span class="token punctuation">.</span>children<span class="token punctuation">,</span> roles<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;roles&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getResultRouters</span><span class="token punctuation">(</span><span class="token parameter">treeData<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  treeData<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">ele</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>path <span class="token operator">==</span> ele<span class="token punctuation">.</span>funcUrl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>roles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>children <span class="token operator">&amp;&amp;</span> element<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">getResultRouters</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>children<span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> treeData<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
  routes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  addRoutes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mutations <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">SET_ROUTES</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> routes</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//保存动态路由时 将静态路由和动态路由合并</span>
    state<span class="token punctuation">.</span>addRoutes <span class="token operator">=</span> routes<span class="token punctuation">;</span>
    state<span class="token punctuation">.</span>routes <span class="token operator">=</span> constantRoutes<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>routes<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">generateRoutes</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> commit <span class="token punctuation">}</span><span class="token punctuation">,</span> roles</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> resetRouters<span class="token punctuation">,</span> accessedRoutes<span class="token punctuation">;</span>
      resetRouters <span class="token operator">=</span> <span class="token function">getResultRouters</span><span class="token punctuation">(</span>asyncRoutes<span class="token punctuation">,</span> roles<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>resetRouters<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>resetRouters<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      accessedRoutes <span class="token operator">=</span> <span class="token function">filterAsyncRoutes</span><span class="token punctuation">(</span>resetRouters<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>accessedRoutes<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;SET_ROUTES&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;SET_ROUTES&quot;</span><span class="token punctuation">,</span> accessedRoutes<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>accessedRoutes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  namespaced<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  state<span class="token punctuation">,</span>
  mutations<span class="token punctuation">,</span>
  actions<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br></div></div><p><a href="https://www.cnblogs.com/shuran/p/10616824.html" target="_blank" rel="noopener noreferrer">可参考链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2-按钮级别权限控制"><a href="#_2-按钮级别权限控制" class="header-anchor">#</a> 2. 按钮级别权限控制</h2> <h4 id="_2-1-思路"><a href="#_2-1-思路" class="header-anchor">#</a> 2.1 思路：</h4> <ul><li><p>页面展示需要鉴权的所有按钮，需要先鉴权菜单权限的显示与隐藏。</p></li> <li><p>勾选每个角色或者用户所能看的权限保存在数据库。该权限数据是一个权限字段的数组。</p></li> <li><p>全局自定义指令（directive）控制按钮权限数据的方法，登入时获取后端传来的按钮权限数组。</p></li> <li><p>在每个按钮中调用该指令，并传入该操作的权限字段和后端保存的权限字段进行匹配，能匹配则该操作按钮可显示</p></li></ul> <blockquote><p>我们公司这一块是不用根据菜单权限，来判断按钮权限，只需要根据后端返回的权限字段的数组判断就好了，然后这一块我们公司也是做的指令封装，代码如下</p></blockquote> <h4 id="_2-2-使用方法"><a href="#_2-2-使用方法" class="header-anchor">#</a> 2.2 使用方法</h4> <ul><li><p>在<code>/src/directive/</code>新建<code>/btnPermission/btnPermission.js</code></p> <blockquote><p>/src/directive/btnPermission/btnPermission.js</p></blockquote></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> hasPermission <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">install</span><span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">&quot;hasPermission&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> permissionsNameList <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>
          localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;buttonCode&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//按钮数组列表</span>
        <span class="token keyword">const</span> permissions <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>permissionsNameList<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回一个由一个给定对象的自身可枚举属性组成的数组，对象的key</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>permissions<span class="token punctuation">,</span> <span class="token string">&quot;permissions&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> value <span class="token operator">=</span> binding<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token keyword">let</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> v <span class="token keyword">of</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">//遍历传进来的数组</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>permissions<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//判断后端给的数组，是否包含传进来的这个字段，包含则显示，不包含则隐藏</span>
            flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>el<span class="token punctuation">.</span>parentNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            el<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><ul><li>在<code>/src/main.js</code>引入</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入权限按钮文件</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> hasPermission <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../src/directive/btnPermission/btnPermission.js&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 按钮权限指令</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>hasPermission<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 按钮权限指令</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>使用方法</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span>
  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inquireButton<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">v-hasPermission</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[<span class="token punctuation">'</span>platectrl_b_policy_search<span class="token punctuation">'</span>]<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inquire<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>查询<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span>
<span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span>
  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>addNewButton<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">v-hasPermission</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[<span class="token punctuation">'</span>platectrl_b_policy_add<span class="token punctuation">'</span>]<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>addNew<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>新增<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span>
<span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><a href="https://blog.csdn.net/cwin8951/article/details/106938968?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control" target="_blank" rel="noopener noreferrer">可参考链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h1 id="七、媒体查询移动、pc-兼容"><a href="#七、媒体查询移动、pc-兼容" class="header-anchor">#</a> 七、媒体查询移动、PC 兼容</h1> <blockquote><p>虽然 element 框架有一些自适应的处理，但是还是有一些需要调整，所以我就自己写了一套媒体查询，哪里需要做一些样式处理，只需要在对应的屏幕宽度下面修改就好，这里我的 rem 计算方法是<code>px/10/2</code>或者直接根据媒体查询调整；</p></blockquote> <h2 id="_1-用法"><a href="#_1-用法" class="header-anchor">#</a> 1. 用法：</h2> <ul><li>先在<code>/src/styles/</code>里面新建<code>media.scss</code></li> <li>引入到<code>/src/index.scss/</code>里面</li></ul> <blockquote><p>直接在index.scss引入就好</p></blockquote> <div class="language-scss line-numbers-mode"><pre class="language-scss"><code><span class="token keyword">@import</span> <span class="token string">'./variables.scss'</span><span class="token punctuation">;</span>
<span class="token keyword">@import</span> <span class="token string">'./mixin.scss'</span><span class="token punctuation">;</span>
<span class="token keyword">@import</span> <span class="token string">'./transition.scss'</span><span class="token punctuation">;</span>
<span class="token keyword">@import</span> <span class="token string">'./element-ui.scss'</span><span class="token punctuation">;</span>
<span class="token keyword">@import</span> <span class="token string">'./sidebar.scss'</span><span class="token punctuation">;</span>
<span class="token keyword">@import</span> <span class="token string">'./btn.scss'</span><span class="token punctuation">;</span>

<span class="token keyword">@import</span> <span class="token string">&quot;./media.scss&quot;</span><span class="token punctuation">;</span> <span class="token comment">/*媒体查询的css*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>代码如下</li></ul> <div class="language-scss line-numbers-mode"><pre class="language-scss"><code><span class="token comment">/* -----------mobile----------- */</span>
<span class="token atrule"><span class="token rule">@media</span> screen <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> 480px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* 登录自适应 */</span>
  <span class="token selector">.login-right </span><span class="token punctuation">{</span>
    <span class="token property">min-width</span><span class="token punctuation">:</span> 20rem<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.bg-container </span><span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.login-left </span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.login-left-title_phone </span><span class="token punctuation">{</span>
    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 1.4rem<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* 登录自适应 end*/</span>

  <span class="token comment">/* 弹窗自适应 dialog */</span>
  <span class="token selector">.Dialog-box </span><span class="token punctuation">{</span>
    <span class="token property">max-height</span><span class="token punctuation">:</span> 60%<span class="token punctuation">;</span>

    <span class="token selector">.el-dialog </span><span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 80% <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.el-form-item--medium .el-form-item__label </span><span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 106px <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.el-form-item--medium .el-form-item__content </span><span class="token punctuation">{</span>
      <span class="token property">margin-left</span><span class="token punctuation">:</span> 72px <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 按钮位置</span>
  <span class="token selector">.el-form-item-btns </span><span class="token punctuation">{</span>
    <span class="token property">float</span><span class="token punctuation">:</span> left <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.inquireButton-father </span><span class="token punctuation">{</span>
    <span class="token comment">// float: none !important;</span>
    <span class="token comment">// width: 22% !important;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* -----------ipad small----------- */</span>
<span class="token atrule"><span class="token rule">@media</span> screen <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">min-device-width</span><span class="token punctuation">:</span> 481px<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">max-device-width</span><span class="token punctuation">:</span> 768px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* 登录自适应 */</span>
  <span class="token selector">.login-right </span><span class="token punctuation">{</span>
    <span class="token property">min-width</span><span class="token punctuation">:</span> 20rem<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.bg-container </span><span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.login-left </span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.login-left-title_phone </span><span class="token punctuation">{</span>
    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 1.4rem<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* 弹窗自适应 dialog */</span>
  <span class="token selector">.Dialog-box </span><span class="token punctuation">{</span>
    <span class="token property">max-height</span><span class="token punctuation">:</span> 60%<span class="token punctuation">;</span>

    <span class="token selector">.el-dialog </span><span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 80% <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.el-form-item--medium .el-form-item__label </span><span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 106px <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.el-form-item--medium .el-form-item__content </span><span class="token punctuation">{</span>
      <span class="token property">margin-left</span><span class="token punctuation">:</span> 72px <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 按钮位置</span>
  <span class="token selector">.el-form-item-btns </span><span class="token punctuation">{</span>
    <span class="token property">float</span><span class="token punctuation">:</span> left <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.inquireButton-father </span><span class="token punctuation">{</span>
    <span class="token comment">// float: none !important;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 22% <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* ----------- iPad  big----------- */</span>

<span class="token atrule"><span class="token rule">@media</span> screen <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">min-device-width</span><span class="token punctuation">:</span> 768px<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">max-device-width</span><span class="token punctuation">:</span> 1024px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* 登录自适应 */</span>
  <span class="token selector">.user-input </span><span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 0 2%<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 9rem<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* 弹窗自适应 dialog */</span>
  <span class="token selector">.Dialog-box </span><span class="token punctuation">{</span>
    <span class="token property">max-height</span><span class="token punctuation">:</span> 60%<span class="token punctuation">;</span>

    <span class="token selector">.el-dialog </span><span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 80% <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.el-form-item--medium .el-form-item__label </span><span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 106px <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.el-form-item--medium .el-form-item__content </span><span class="token punctuation">{</span>
      <span class="token property">margin-left</span><span class="token punctuation">:</span> 72px <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 按钮位置</span>
  <span class="token selector">.el-form-item-btns </span><span class="token punctuation">{</span>
    <span class="token property">float</span><span class="token punctuation">:</span> left <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.inquireButton-father </span><span class="token punctuation">{</span>
    <span class="token comment">// float: none !important;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 22% <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/* ----------- iPad Pro 屏幕小的笔记本----------- */</span>
<span class="token comment">/* Portrait and Landscape */</span>
<span class="token atrule"><span class="token rule">@media</span> only screen <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">min-device-width</span><span class="token punctuation">:</span> 1025px<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">max-device-width</span><span class="token punctuation">:</span> 1366px<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> 1.5<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* 登录自适应 */</span>
  <span class="token selector">.login-right </span><span class="token punctuation">{</span>
    <span class="token property">min-width</span><span class="token punctuation">:</span> 27rem<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* Portrait */</span>
<span class="token atrule"><span class="token rule">@media</span> only screen <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">min-device-width</span><span class="token punctuation">:</span> 1024px<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">max-device-width</span><span class="token punctuation">:</span> 1366px<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">orientation</span><span class="token punctuation">:</span> portrait<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> 1.5<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* 登录自适应 */</span>
  <span class="token selector">.login-right </span><span class="token punctuation">{</span>
    <span class="token property">min-width</span><span class="token punctuation">:</span> 27rem<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* Landscape */</span>
<span class="token atrule"><span class="token rule">@media</span> only screen <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">min-device-width</span><span class="token punctuation">:</span> 1024px<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">max-device-width</span><span class="token punctuation">:</span> 1366px<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">orientation</span><span class="token punctuation">:</span> landscape<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> 1.5<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* 登录自适应 */</span>
  <span class="token selector">.login-right </span><span class="token punctuation">{</span>
    <span class="token property">min-width</span><span class="token punctuation">:</span> 27rem<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br></div></div><p><a href="https://www.jianshu.com/p/26bbb9120c6d" target="_blank" rel="noopener noreferrer">vue 中 rem 用法及 scss<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h1 id="个人建议"><a href="#个人建议" class="header-anchor">#</a> 个人建议：</h1> <blockquote><p>如果拿来开发的话，建议选用<code>vue-admin-template</code>这套框架，这是<code>vue-element-admin</code>的极简版本，它只包含了 Element UI &amp; axios &amp; iconfont &amp; permission control &amp; lint，这些搭建后台必要的东西；如果想用<code>vue-element-admin</code>的东西，也是可以直接拿过来就用的，就不会有那么多的代码沉余；</p></blockquote> <p><a href="https://github.com/PanJiaChen/vue-admin-template/blob/master/README-zh.md" target="_blank" rel="noopener noreferrer">vue-admin-template官方文档链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h1 id="总结"><a href="#总结" class="header-anchor">#</a> 总结：</h1> <blockquote><p>框架功能比较丰富，社区完整，是个值得入手学习的框架；现在还是在初期使用阶段，一些细节上的技术点，会在使用中持续更新；</p></blockquote> <p>可参考链接：https://www.jianshu.com/p/d3e3b21696e4</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/electron和electron-vue的简单介绍.html" class="prev">
        electron和electron-vue的简单介绍
      </a></span> <span class="next"><a href="/docs/解决vue-element-admin Tags-view标签刷新消失问题.html">
        解决vue-element-admin Tags-view标签刷新消失问题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.436fbc8c.js" defer></script><script src="/assets/js/2.816dcc9d.js" defer></script><script src="/assets/js/3.48361560.js" defer></script>
  </body>
</html>
